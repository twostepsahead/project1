How to build Unleashed
======================

Install Unleashed
-----------------

Building Unleashed requires Unleashed, so first, download and install the
latest snapshot from https://www.unleashed-os.org/snapshots/latest/

Get the source
--------------

Clone this repository:

```
$ git clone git://repo.or.cz/unleashed.git
$ cd unleashed
```

Build
-----

Objects generated during the build are stored in `/usr/obj`, so create it and
allow the build user to write to it.

```
# zfs create -o mountpoint=/usr/obj rpool/obj && install -m 1777 -d /usr/obj
```

Afterward, you can use make normally.

```
$ make -j32 build            # adjust -j<num> as necessary for your hardware
```

`make build` installs the built artifacts into `proto/root_i386`, and generates
packages into the `packages/nightly/repo.redist` repository.

NOTE: objects generated by the legacy build system `dmake` in the `usr/src`
directories are stored directly inside the directories, so it is currently not
enough to clear `/usr/obj` to get a clean workspace. Instead use:
```
$ make -j32 cleandir         # removes objects, proto/root_i386 and packages/i386/nightly/repo.redist
```

Single component build
----------------------

To build a component that is using the new build system (e.g., cat(1)), change
into the source directory and run make. For example:

```
$ cd bin/cat
$ make
# make install
```

The component will be linked against the running system and installed to `/`.
To install to an alternate directory (eg. `proto/root_i386`), use `make install
DESTDIR=path`.

To build a component under the legacy (dmake) build system, ie. things under
`usr/src`, first complete a full build so that prerequisite objects for the
component are made, and then:

```
$ ./tools/bldenv.sh
$ cd usr/src/cmd/w
$ dmake install
```

The component will be built against the "proto area" in `proto/root_i386` and
installed there.
# project1
